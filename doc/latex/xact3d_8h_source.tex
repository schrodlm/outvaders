\hypertarget{xact3d_8h_source}{}\doxysection{xact3d.\+h}
\label{xact3d_8h_source}\index{src/lib/dx/Include/xact3d.h@{src/lib/dx/Include/xact3d.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*-\/========================================================================-\/\_}}
\DoxyCodeLine{2 \textcolor{comment}{ |                                -\/ XACT3D -\/                                |}}
\DoxyCodeLine{3 \textcolor{comment}{ |        Copyright (c) Microsoft Corporation.  All rights reserved.        |}}
\DoxyCodeLine{4 \textcolor{comment}{ |\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~|}}
\DoxyCodeLine{5 \textcolor{comment}{ |VERSION:  0.1                         MODEL:   Unmanaged User-\/mode        |}}
\DoxyCodeLine{6 \textcolor{comment}{ |CONTRACT: N / A                       EXCEPT:  No Exceptions              |}}
\DoxyCodeLine{7 \textcolor{comment}{ |PARENT:   N / A                       MINREQ:  Win2000, Xbox360           |}}
\DoxyCodeLine{8 \textcolor{comment}{ |PROJECT:  XACT3D                      DIALECT: MS Visual C++ 7.0          |}}
\DoxyCodeLine{9 \textcolor{comment}{ |>-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/<|}}
\DoxyCodeLine{10 \textcolor{comment}{ | DUTY: XACT 3D support                                                    |}}
\DoxyCodeLine{11 \textcolor{comment}{ \string^\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string^}}
\DoxyCodeLine{12 \textcolor{comment}{  NOTES:}}
\DoxyCodeLine{13 \textcolor{comment}{    1.  See X3DAudio.h for information regarding X3DAudio types.            */}}
\DoxyCodeLine{14 }
\DoxyCodeLine{15 }
\DoxyCodeLine{16 \textcolor{preprocessor}{\#ifndef \_\_XACT3D\_H\_\_}}
\DoxyCodeLine{17 \textcolor{preprocessor}{\#define \_\_XACT3D\_H\_\_}}
\DoxyCodeLine{18 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/<D-\/E-\/F-\/I-\/N-\/I-\/T-\/I-\/O-\/N-\/S>-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\///}}
\DoxyCodeLine{19 \textcolor{preprocessor}{    \#include <x3daudio.h>}}
\DoxyCodeLine{20 \textcolor{preprocessor}{    \#include <xact.h>}}
\DoxyCodeLine{21 }
\DoxyCodeLine{22     \textcolor{comment}{// Supported speaker positions, represented as azimuth angles.}}
\DoxyCodeLine{23     \textcolor{comment}{//}}
\DoxyCodeLine{24     \textcolor{comment}{// Here's a picture of the azimuth angles for the 8 cardinal points,}}
\DoxyCodeLine{25     \textcolor{comment}{// seen from above.  The emitter's base position is at the origin 0.}}
\DoxyCodeLine{26     \textcolor{comment}{//}}
\DoxyCodeLine{27     \textcolor{comment}{//           FRONT}}
\DoxyCodeLine{28     \textcolor{comment}{//             | 0  <-\/-\/ azimuth}}
\DoxyCodeLine{29     \textcolor{comment}{//             |}}
\DoxyCodeLine{30     \textcolor{comment}{//    7pi/4 \(\backslash\)  |  / pi/4}}
\DoxyCodeLine{31     \textcolor{comment}{//           \(\backslash\) | /}}
\DoxyCodeLine{32     \textcolor{comment}{// LEFT       \(\backslash\)|/      RIGHT}}
\DoxyCodeLine{33     \textcolor{comment}{// 3pi/2-\/-\/-\/-\/-\/-\/-\/0-\/-\/-\/-\/-\/-\/-\/pi/2}}
\DoxyCodeLine{34     \textcolor{comment}{//            /|\(\backslash\)}}
\DoxyCodeLine{35 \textcolor{comment}{    //           / | \(\backslash\)}}
\DoxyCodeLine{36 \textcolor{comment}{    //    5pi/4 /  |  \(\backslash\) 3pi/4}}
\DoxyCodeLine{37     \textcolor{comment}{//             |}}
\DoxyCodeLine{38     \textcolor{comment}{//             | pi}}
\DoxyCodeLine{39     \textcolor{comment}{//           BACK}}
\DoxyCodeLine{40     \textcolor{comment}{//}}
\DoxyCodeLine{41 \textcolor{preprocessor}{    \#define LEFT\_AZIMUTH                    (3*X3DAUDIO\_PI/2)}}
\DoxyCodeLine{42 \textcolor{preprocessor}{    \#define RIGHT\_AZIMUTH                   (X3DAUDIO\_PI/2)}}
\DoxyCodeLine{43 \textcolor{preprocessor}{    \#define FRONT\_LEFT\_AZIMUTH              (7*X3DAUDIO\_PI/4)}}
\DoxyCodeLine{44 \textcolor{preprocessor}{    \#define FRONT\_RIGHT\_AZIMUTH             (X3DAUDIO\_PI/4)}}
\DoxyCodeLine{45 \textcolor{preprocessor}{    \#define FRONT\_CENTER\_AZIMUTH            0.0f}}
\DoxyCodeLine{46 \textcolor{preprocessor}{    \#define LOW\_FREQUENCY\_AZIMUTH           X3DAUDIO\_2PI}}
\DoxyCodeLine{47 \textcolor{preprocessor}{    \#define BACK\_LEFT\_AZIMUTH               (5*X3DAUDIO\_PI/4)}}
\DoxyCodeLine{48 \textcolor{preprocessor}{    \#define BACK\_RIGHT\_AZIMUTH              (3*X3DAUDIO\_PI/4)}}
\DoxyCodeLine{49 \textcolor{preprocessor}{    \#define BACK\_CENTER\_AZIMUTH             X3DAUDIO\_PI}}
\DoxyCodeLine{50 \textcolor{preprocessor}{    \#define FRONT\_LEFT\_OF\_CENTER\_AZIMUTH    (15*X3DAUDIO\_PI/8)}}
\DoxyCodeLine{51 \textcolor{preprocessor}{    \#define FRONT\_RIGHT\_OF\_CENTER\_AZIMUTH   (X3DAUDIO\_PI/8)}}
\DoxyCodeLine{52 }
\DoxyCodeLine{53 }
\DoxyCodeLine{54 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/<D-\/A-\/T-\/A-\/-\/-\/T-\/Y-\/P-\/E-\/S>-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\///}}
\DoxyCodeLine{55     \textcolor{comment}{// Supported emitter channel layouts:}}
\DoxyCodeLine{56     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{float} aStereoLayout[] =}
\DoxyCodeLine{57     \{}
\DoxyCodeLine{58         LEFT\_AZIMUTH,}
\DoxyCodeLine{59         RIGHT\_AZIMUTH}
\DoxyCodeLine{60     \};}
\DoxyCodeLine{61     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{float} a2Point1Layout[] =}
\DoxyCodeLine{62     \{}
\DoxyCodeLine{63         LEFT\_AZIMUTH,}
\DoxyCodeLine{64         RIGHT\_AZIMUTH,}
\DoxyCodeLine{65         LOW\_FREQUENCY\_AZIMUTH}
\DoxyCodeLine{66     \};}
\DoxyCodeLine{67     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{float} aQuadLayout[] =}
\DoxyCodeLine{68     \{}
\DoxyCodeLine{69         FRONT\_LEFT\_AZIMUTH,}
\DoxyCodeLine{70         FRONT\_RIGHT\_AZIMUTH,}
\DoxyCodeLine{71         BACK\_LEFT\_AZIMUTH,}
\DoxyCodeLine{72         BACK\_RIGHT\_AZIMUTH}
\DoxyCodeLine{73     \};}
\DoxyCodeLine{74     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{float} a5Point1Layout[] =}
\DoxyCodeLine{75     \{}
\DoxyCodeLine{76         FRONT\_LEFT\_AZIMUTH,}
\DoxyCodeLine{77         FRONT\_RIGHT\_AZIMUTH,}
\DoxyCodeLine{78         FRONT\_CENTER\_AZIMUTH,}
\DoxyCodeLine{79         LOW\_FREQUENCY\_AZIMUTH,}
\DoxyCodeLine{80         BACK\_LEFT\_AZIMUTH,}
\DoxyCodeLine{81         BACK\_RIGHT\_AZIMUTH}
\DoxyCodeLine{82     \};}
\DoxyCodeLine{83     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{float} a7Point1Layout[] =}
\DoxyCodeLine{84     \{}
\DoxyCodeLine{85         FRONT\_LEFT\_AZIMUTH,}
\DoxyCodeLine{86         FRONT\_RIGHT\_AZIMUTH,}
\DoxyCodeLine{87         FRONT\_CENTER\_AZIMUTH,}
\DoxyCodeLine{88         LOW\_FREQUENCY\_AZIMUTH,}
\DoxyCodeLine{89         BACK\_LEFT\_AZIMUTH,}
\DoxyCodeLine{90         BACK\_RIGHT\_AZIMUTH,}
\DoxyCodeLine{91         LEFT\_AZIMUTH,}
\DoxyCodeLine{92         RIGHT\_AZIMUTH}
\DoxyCodeLine{93     \};}
\DoxyCodeLine{94 }
\DoxyCodeLine{95 }
\DoxyCodeLine{96 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/<F-\/U-\/N-\/C-\/T-\/I-\/O-\/N-\/S>-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\///}}
\DoxyCodeLine{98 \textcolor{comment}{}    \textcolor{comment}{// DESCRIPTION:}}
\DoxyCodeLine{99     \textcolor{comment}{//  Calculates DSP settings with respect to 3D parameters:}}
\DoxyCodeLine{100     \textcolor{comment}{//}}
\DoxyCodeLine{101     \textcolor{comment}{// REMARKS:}}
\DoxyCodeLine{102     \textcolor{comment}{//  The number of bits set in SpeakerChannelMask should equal the number of}}
\DoxyCodeLine{103     \textcolor{comment}{//  channels expected on the final mix.}}
\DoxyCodeLine{104     \textcolor{comment}{//}}
\DoxyCodeLine{105     \textcolor{comment}{// PARAMETERS:}}
\DoxyCodeLine{106     \textcolor{comment}{//  SpeakerChannelMask -\/ [in]  speaker geometry configuration on the final mix, specifies assignment of channels to speaker positions, defined as per WAVEFORMATEXTENSIBLE.dwChannelMask, must be != 0}}
\DoxyCodeLine{107     \textcolor{comment}{//                             Currently only (SPEAKER\_FRONT\_LEFT | SPEAKER\_FRONT\_RIGHT) is supported by XACT.}}
\DoxyCodeLine{108     \textcolor{comment}{//  pListener          -\/ [in]  point of 3D audio reception}}
\DoxyCodeLine{109     \textcolor{comment}{//  pEmitter           -\/ [in]  3D audio source}}
\DoxyCodeLine{110     \textcolor{comment}{//  pDSPSettings       -\/ [out] receives calculation results, applied to an XACT cue via XACT3DApply}}
\DoxyCodeLine{111     \textcolor{comment}{//  pEngine            -\/ [in]  pointer to the XACT engine}}
\DoxyCodeLine{112     \textcolor{comment}{//}}
\DoxyCodeLine{113     \textcolor{comment}{// RETURN VALUE:}}
\DoxyCodeLine{114     \textcolor{comment}{//  HResult error code}}
\DoxyCodeLine{116 \textcolor{comment}{}    EXTERN\_C HRESULT \textcolor{keyword}{inline} XACT3DCalculate (UINT32 SpeakerChannelMask, \textcolor{keyword}{const} \mbox{\hyperlink{struct_x3_d_a_u_d_i_o___l_i_s_t_e_n_e_r}{X3DAUDIO\_LISTENER}}* pListener, \mbox{\hyperlink{struct_x3_d_a_u_d_i_o___e_m_i_t_t_e_r}{X3DAUDIO\_EMITTER}}* pEmitter, \mbox{\hyperlink{struct_x3_d_a_u_d_i_o___d_s_p___s_e_t_t_i_n_g_s}{X3DAUDIO\_DSP\_SETTINGS}}* pDSPSettings, IXACTEngine* pEngine)}
\DoxyCodeLine{117     \{}
\DoxyCodeLine{118         XACTVARIABLEINDEX xactSpeedOfSoundID = pEngine-\/>GetGlobalVariableIndex(\textcolor{stringliteral}{"{}SpeedOfSound"{}});}
\DoxyCodeLine{119         XACTVARIABLEVALUE nSpeedOfSound;}
\DoxyCodeLine{120         HRESULT hr = pEngine-\/>GetGlobalVariable(xactSpeedOfSoundID, \&nSpeedOfSound);}
\DoxyCodeLine{121 }
\DoxyCodeLine{122         \textcolor{keywordflow}{if} (SUCCEEDED(hr)) \{}
\DoxyCodeLine{123             X3DAUDIO\_HANDLE X3DInstance;}
\DoxyCodeLine{124             X3DAudioInitialize(SpeakerChannelMask, nSpeedOfSound, X3DInstance);}
\DoxyCodeLine{125 }
\DoxyCodeLine{126             \textcolor{keywordflow}{if} (pEmitter-\/>ChannelCount > 1 \&\& pEmitter-\/>pChannelAzimuths == NULL) \{}
\DoxyCodeLine{127                 pEmitter-\/>ChannelRadius = 1.0f;}
\DoxyCodeLine{128 }
\DoxyCodeLine{129                 \textcolor{keywordflow}{switch} (pEmitter-\/>ChannelCount) \{}
\DoxyCodeLine{130                     \textcolor{keywordflow}{case} 2: pEmitter-\/>pChannelAzimuths = (\textcolor{keywordtype}{float}*)\&aStereoLayout[0]; \textcolor{keywordflow}{break};}
\DoxyCodeLine{131                     \textcolor{keywordflow}{case} 3: pEmitter-\/>pChannelAzimuths = (\textcolor{keywordtype}{float}*)\&a2Point1Layout[0]; \textcolor{keywordflow}{break};}
\DoxyCodeLine{132                     \textcolor{keywordflow}{case} 4: pEmitter-\/>pChannelAzimuths = (\textcolor{keywordtype}{float}*)\&aQuadLayout[0]; \textcolor{keywordflow}{break};}
\DoxyCodeLine{133                     \textcolor{keywordflow}{case} 5: pEmitter-\/>pChannelAzimuths = (\textcolor{keywordtype}{float}*)\&a5Point1Layout[0]; \textcolor{keywordflow}{break};}
\DoxyCodeLine{134                     \textcolor{keywordflow}{case} 7: pEmitter-\/>pChannelAzimuths = (\textcolor{keywordtype}{float}*)\&a7Point1Layout[0]; \textcolor{keywordflow}{break};}
\DoxyCodeLine{135                     \textcolor{keywordflow}{default}: hr = E\_FAIL; \textcolor{keywordflow}{break};}
\DoxyCodeLine{136                 \}}
\DoxyCodeLine{137             \}}
\DoxyCodeLine{138 }
\DoxyCodeLine{139             \mbox{\hyperlink{struct_x3_d_a_u_d_i_o___d_i_s_t_a_n_c_e___c_u_r_v_e___p_o_i_n_t}{X3DAUDIO\_DISTANCE\_CURVE\_POINT}} DefaultCurvePoints[2] = \{ 0.0f, 1.0f, 1.0f, 1.0f \};}
\DoxyCodeLine{140             \mbox{\hyperlink{struct_x3_d_a_u_d_i_o___d_i_s_t_a_n_c_e___c_u_r_v_e}{X3DAUDIO\_DISTANCE\_CURVE}}       DefaultCurve          = \{ (\mbox{\hyperlink{struct_x3_d_a_u_d_i_o___d_i_s_t_a_n_c_e___c_u_r_v_e___p_o_i_n_t}{X3DAUDIO\_DISTANCE\_CURVE\_POINT}}*)\&DefaultCurvePoints[0], 2 \};}
\DoxyCodeLine{141             \textcolor{keywordflow}{if} (pEmitter-\/>pVolumeCurve == NULL) \{}
\DoxyCodeLine{142                 pEmitter-\/>pVolumeCurve = \&DefaultCurve;}
\DoxyCodeLine{143             \}}
\DoxyCodeLine{144             \textcolor{keywordflow}{if} (pEmitter-\/>pLFECurve == NULL) \{}
\DoxyCodeLine{145                 pEmitter-\/>pLFECurve = \&DefaultCurve;}
\DoxyCodeLine{146             \}}
\DoxyCodeLine{147 }
\DoxyCodeLine{148             \textcolor{keywordflow}{if} (SUCCEEDED(hr)) \{}
\DoxyCodeLine{149                 X3DAudioCalculate(X3DInstance, pListener, pEmitter, X3DAUDIO\_CALCULATE\_MATRIX | X3DAUDIO\_CALCULATE\_DOPPLER | X3DAUDIO\_CALCULATE\_EMITTER\_ANGLE, pDSPSettings);}
\DoxyCodeLine{150             \}}
\DoxyCodeLine{151         \}}
\DoxyCodeLine{152 }
\DoxyCodeLine{153         \textcolor{keywordflow}{return} hr;}
\DoxyCodeLine{154     \}}
\DoxyCodeLine{155 }
\DoxyCodeLine{156 }
\DoxyCodeLine{158     \textcolor{comment}{// DESCRIPTION:}}
\DoxyCodeLine{159     \textcolor{comment}{//  Applies a 3D calculation returned by XACT3DCalculate to a cue:}}
\DoxyCodeLine{160     \textcolor{comment}{//}}
\DoxyCodeLine{161     \textcolor{comment}{// PARAMETERS:}}
\DoxyCodeLine{162     \textcolor{comment}{//  pDSPSettings -\/ [in] calculation results generated by XACT3DCalculate}}
\DoxyCodeLine{163     \textcolor{comment}{//  pCue         -\/ [in] cue to which to apply pDSPSettings}}
\DoxyCodeLine{164     \textcolor{comment}{//  ChannelCount -\/ [in] should be set equal to pDSPSettings-\/>SrcChannelCount.}}
\DoxyCodeLine{165     \textcolor{comment}{//}}
\DoxyCodeLine{166     \textcolor{comment}{// RETURN VALUE:}}
\DoxyCodeLine{167     \textcolor{comment}{//  HResult error code}}
\DoxyCodeLine{169 \textcolor{comment}{}    EXTERN\_C HRESULT \textcolor{keyword}{inline} XACT3DApply (\mbox{\hyperlink{struct_x3_d_a_u_d_i_o___d_s_p___s_e_t_t_i_n_g_s}{X3DAUDIO\_DSP\_SETTINGS}}* pDSPSettings, IXACTCue* pCue, UINT32 ChannelCount)}
\DoxyCodeLine{170     \{}
\DoxyCodeLine{171         HRESULT hr = pCue-\/>SetMatrixCoefficients(ChannelCount, 2, pDSPSettings-\/>pMatrixCoefficients);}
\DoxyCodeLine{172 }
\DoxyCodeLine{173         \textcolor{keywordflow}{if} SUCCEEDED(hr) \{}
\DoxyCodeLine{174             XACTVARIABLEINDEX xactDistanceID = pCue-\/>GetVariableIndex(\textcolor{stringliteral}{"{}Distance"{}});}
\DoxyCodeLine{175             hr = pCue-\/>SetVariable(xactDistanceID, pDSPSettings-\/>EmitterToListenerDistance);}
\DoxyCodeLine{176         \}}
\DoxyCodeLine{177         \textcolor{keywordflow}{if} SUCCEEDED(hr) \{}
\DoxyCodeLine{178             XACTVARIABLEINDEX xactDopplerID = pCue-\/>GetVariableIndex(\textcolor{stringliteral}{"{}DopplerPitchScalar"{}});}
\DoxyCodeLine{179             hr = pCue-\/>SetVariable(xactDopplerID, pDSPSettings-\/>DopplerFactor);}
\DoxyCodeLine{180         \}}
\DoxyCodeLine{181         \textcolor{keywordflow}{if} SUCCEEDED(hr) \{}
\DoxyCodeLine{182             XACTVARIABLEINDEX xactOrientationID = pCue-\/>GetVariableIndex(\textcolor{stringliteral}{"{}OrientationAngle"{}});}
\DoxyCodeLine{183             hr = pCue-\/>SetVariable(xactOrientationID, pDSPSettings-\/>EmitterToListenerAngle * (180.0f / X3DAUDIO\_PI));}
\DoxyCodeLine{184         \}}
\DoxyCodeLine{185 }
\DoxyCodeLine{186         \textcolor{keywordflow}{return} hr;}
\DoxyCodeLine{187     \}}
\DoxyCodeLine{188 }
\DoxyCodeLine{189 }
\DoxyCodeLine{190 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// \_\_XACT3D\_H\_\_}}
\DoxyCodeLine{191 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/<-\/EOF-\/>-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\///}}

\end{DoxyCode}
